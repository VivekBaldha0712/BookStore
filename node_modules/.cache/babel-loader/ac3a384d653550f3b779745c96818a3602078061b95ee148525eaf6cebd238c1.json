{"ast":null,"code":"var _jsxFileName = \"F:\\\\BookStore-main\\\\src\\\\context\\\\auth.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useEffect, useState } from \"react\";\nimport React from \"react\";\nimport Shared from \"../utils/shared\";\nimport { RoutePaths } from \"../utils/enum\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { toast } from \"react-toastify\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialUserValue = {\n  id: 0,\n  email: \"\",\n  firstName: \"\",\n  lastName: \"\",\n  roleId: 0,\n  role: \"\",\n  password: \"\"\n};\nconst initialState = {\n  setUser: () => {},\n  user: initialUserValue,\n  signOut: () => {},\n  appInitialize: false\n};\nexport const AuthContext = /*#__PURE__*/createContext(initialState);\nexport const AuthWrapper = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [appInitialize, setAppInitialize] = useState(false);\n  const [user, _setUser] = useState(initialUserValue);\n  const navigate = useNavigate();\n  const {\n    pathname\n  } = useLocation();\n  const setUser = user => {\n    localStorage.setItem(Shared.LocalStorageKeys.USER, JSON.stringify(user));\n    _setUser(user);\n  };\n  useEffect(() => {\n    const itemStr = JSON.parse(localStorage.getItem(Shared.LocalStorageKeys.USER)) || initialUserValue;\n    if (!itemStr.id) {\n      navigate(`${RoutePaths.Login}`);\n    }\n    _setUser(itemStr);\n  }, []);\n  const signOut = () => {\n    setUser(initialUserValue);\n    localStorage.removeItem(Shared.LocalStorageKeys.USER);\n    navigate(`${RoutePaths.Login}`);\n  };\n  useEffect(() => {\n    if (pathname === RoutePaths.Login && user.id) {\n      navigate(RoutePaths.BookListing);\n    }\n    if (!user.id) {\n      return;\n    }\n    const access = Shared.hasAccess(pathname, user);\n    if (!access) {\n      toast.warning(\"Sorry, you are not authorized to access this page\");\n      navigate(RoutePaths.BookListing);\n      return;\n    }\n    setAppInitialize(true);\n  }, [pathname, user]);\n  let value = {\n    user,\n    setUser,\n    signOut,\n    appInitialize\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 10\n  }, this);\n};\n_s(AuthWrapper, \"k73z315dTBXHMZB4WKdR3VTN7Nw=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = AuthWrapper;\nexport const useAuthContext = () => {\n  _s2();\n  return useContext(AuthContext);\n};\n_s2(useAuthContext, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"AuthWrapper\");","map":{"version":3,"names":["createContext","useContext","useEffect","useState","React","Shared","RoutePaths","useNavigate","useLocation","toast","initialUserValue","id","email","firstName","lastName","roleId","role","password","initialState","setUser","user","signOut","appInitialize","AuthContext","AuthWrapper","children","setAppInitialize","_setUser","navigate","pathname","localStorage","setItem","LocalStorageKeys","USER","JSON","stringify","itemStr","parse","getItem","Login","removeItem","BookListing","access","hasAccess","warning","value","useAuthContext"],"sources":["F:/BookStore-main/src/context/auth.jsx"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from \"react\";\r\nimport React from \"react\";\r\nimport Shared from \"../utils/shared\";\r\nimport { RoutePaths } from \"../utils/enum\";\r\nimport { useNavigate, useLocation } from \"react-router-dom\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst initialUserValue = {\r\n  id: 0,\r\n  email: \"\",\r\n  firstName: \"\",\r\n  lastName: \"\",\r\n  roleId: 0,\r\n  role: \"\",\r\n  password: \"\",\r\n};\r\n\r\nconst initialState = {\r\n  setUser: () => {},\r\n  user: initialUserValue,\r\n  signOut: () => {},\r\n  appInitialize: false,\r\n};\r\n\r\nexport const AuthContext = createContext(initialState);\r\n\r\nexport const AuthWrapper = ({ children }) => {\r\n  const [appInitialize, setAppInitialize] = useState(false);\r\n  const [user, _setUser] = useState(initialUserValue);\r\n\r\n  const navigate = useNavigate();\r\n  const { pathname } = useLocation();\r\n\r\n  const setUser = (user) => {\r\n    localStorage.setItem(Shared.LocalStorageKeys.USER, JSON.stringify(user));\r\n    _setUser(user);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const itemStr =\r\n      JSON.parse(localStorage.getItem(Shared.LocalStorageKeys.USER)) ||\r\n      initialUserValue;\r\n    if (!itemStr.id) {\r\n      navigate(`${RoutePaths.Login}`);\r\n    }\r\n    _setUser(itemStr);\r\n  }, []);\r\n\r\n  const signOut = () => {\r\n    setUser(initialUserValue);\r\n    localStorage.removeItem(Shared.LocalStorageKeys.USER);\r\n    navigate(`${RoutePaths.Login}`);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (pathname === RoutePaths.Login && user.id) {\r\n      navigate(RoutePaths.BookListing);\r\n    }\r\n\r\n    if (!user.id) {\r\n      return;\r\n    }\r\n    const access = Shared.hasAccess(pathname, user);\r\n    if (!access) {\r\n      toast.warning(\"Sorry, you are not authorized to access this page\");\r\n      navigate(RoutePaths.BookListing);\r\n      return;\r\n    }\r\n    setAppInitialize(true);\r\n  }, [pathname, user]);\r\n\r\n  let value = {\r\n    user,\r\n    setUser,\r\n    signOut,\r\n    appInitialize,\r\n  };\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n};\r\n\r\nexport const useAuthContext = () => {\r\n  return useContext(AuthContext);\r\n};\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}